import{b as u,G as $,r as n,u as z,k as E,a as C,j as a,x as F,y as B}from"./index-WfECzoqw.js";const D=async(l,c)=>{try{return await u.post(`/api/v1/comments/${c}`,{content:JSON.stringify(l)},{withCredentials:!0})}catch(d){console.log(d)}};function G(l){return $({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(l)}const P=()=>{const[l,c]=n.useState(!1),[d,g]=n.useState(!1),[h,x]=n.useState(""),[p,N]=n.useState(!1),[y,m]=n.useState(null),w=z(),{videoId:f}=E(),r=C(e=>e.auth.user),{comments:s}=C(e=>e.video),A=async()=>{try{const e=await u.get(`/api/v1/comments/${f}`,{withCredentials:!0});if(e){const t=e.data.data;console.log(t),w(B(t))}}catch(e){console.error("Error fetching data:",e)}},S=async e=>{e.preventDefault(),await D(h,f)&&(c(o=>!o),x(""))},_=async e=>{var t;((t=e==null?void 0:e.owner)==null?void 0:t._id)===(r==null?void 0:r._id)?await u.delete(`/api/v1/comments/c/${e==null?void 0:e._id}`,{withCredentials:!0})&&(c(i=>!i),g(!1)):alert("this is not your comment so you cant delete  it")},k=e=>{m(e),g(t=>!t)};return n.useEffect(()=>{A()},[l]),console.log(s),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"rounded-md mt-3 h-screen",children:[a.jsxs("div",{className:" px-3 mt-5 ml-1 rounded-lg",children:[a.jsx("p",{className:"mt-3",children:Array.isArray(s)&&(s!=null&&s.length)?`${s==null?void 0:s.length} Comments`:"No Comments"}),a.jsxs("form",{className:"mt-3 mb-4 px-2 flex",children:[a.jsx("img",{className:"w-8 h-8 rounded-full mr-4",src:`${r==null?void 0:r.avatar}`,alt:"user"}),a.jsx("input",{onChange:e=>x(e.target.value),value:h,className:"w-[70%] border bg-transparent text-white py-1 px-5 mr-3",type:"text",name:"content",placeholder:"Add a Comment"}),a.jsx("button",{type:"submit",onClick:S,disabled:!r,className:"border px-4 py-1 ml-4 font-semibold hover:bg-gray-800",children:"Add"})]})]}),a.jsx("div",{className:" w-[100%]  justify-between ",children:Array.isArray(s)&&(s==null?void 0:s.length)>0&&(s==null?void 0:s.map((e,t)=>{var o,i,j,b,v;return a.jsxs("div",{className:"flex justify-between hover:bg-zinc-900 border border-l-0 border-r-0 border-b-0 py-3 px-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("img",{className:"w-9 h-9 rounded-full",src:`${(o=e==null?void 0:e.owner)==null?void 0:o.avatar}`,alt:""}),a.jsxs("div",{className:"px-3",children:[a.jsxs("div",{className:"flex",children:[a.jsxs("span",{className:"text-gray-300",children:[a.jsx("p",{className:"font-semibold",children:(i=e==null?void 0:e.owner)==null?void 0:i.fullname}),a.jsxs("p",{children:["@",(j=e==null?void 0:e.owner)==null?void 0:j.username]})]}),a.jsxs("p",{className:"ml-3 text-gray-300",children:["Â· ",F(e==null?void 0:e.createdAt)]})]}),a.jsx("div",{className:"mt-2",children:a.jsx("input",{value:p?h:e==null?void 0:e.content,disabled:!p,onChange:M=>x(M.target.value),className:"mt-2 bg-transparent "})})]})]}),a.jsxs("div",{className:"flex",children:[(r==null?void 0:r._id)===((b=e==null?void 0:e.owner)==null?void 0:b._id)&&a.jsx("div",{className:" h-fit w-fit mr-5 flex",children:d&&y===(e==null?void 0:e._id)&&!p&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>N(!0),className:"bg-green-500 px-3",children:"edit"}),a.jsx("button",{className:"bg-red-500 px-3 ml-2",onClick:()=>_(e),children:"delete"})]})}),(r==null?void 0:r._id)===((v=e==null?void 0:e.owner)==null?void 0:v._id)&&a.jsx("div",{className:"cursor-pointer",onClick:()=>k(e==null?void 0:e._id),children:a.jsx(G,{})})]})]},t)}))})]})})};export{P as default};
