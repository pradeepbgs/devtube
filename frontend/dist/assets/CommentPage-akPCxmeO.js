import{D as p,c as g,G as z,R as E,r as n,u as D,o as F,a as N,j as a,H as B,J as P}from"./index-5wTMoCu5.js";const R=async(l,c)=>{try{return await g.post(`${p}}/${c}`,{content:JSON.stringify(l)},{withCredentials:!0})}catch(d){console.log(d)}};function U(l){return z({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(l)}const G=()=>{const[l,c]=n.useState(!1),[d,f]=n.useState(!1),[h,x]=n.useState(""),[u,y]=n.useState(!1),[m,w]=n.useState(null),$=D(),{videoId:j}=F(),r=N(e=>e.auth.user),{comments:s}=N(e=>e.video),A=async()=>{try{const e=await g.get(`${p}/${j}`,{withCredentials:!0});if(e){const t=e.data.data;console.log(t),$(P(t))}}catch(e){console.error("Error fetching data:",e)}},S=async e=>{e.preventDefault(),await R(h,j)&&(c(o=>!o),x(""))},_=async e=>{var t;((t=e==null?void 0:e.owner)==null?void 0:t._id)===(r==null?void 0:r._id)?await g.delete(`${p}/c/${e==null?void 0:e._id}`,{withCredentials:!0})&&(c(i=>!i),f(!1)):alert("this is not your comment so you cant delete  it")},k=e=>{w(e),f(t=>!t)};return n.useEffect(()=>{A()},[l]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"rounded-md mt-3 h-screen",children:[a.jsxs("div",{className:" px-3 mt-5 ml-1 rounded-lg",children:[a.jsx("p",{className:"mt-3",children:Array.isArray(s)&&(s!=null&&s.length)?`${s==null?void 0:s.length} Comments`:"No Comments"}),a.jsxs("form",{className:"mt-3 mb-4 px-2 flex",children:[a.jsx("img",{className:"w-8 h-8 rounded-full mr-4",src:`${r==null?void 0:r.avatar}`,alt:"user"}),a.jsx("input",{onChange:e=>x(e.target.value),value:h,className:"w-[70%] border bg-transparent text-white py-1 px-5 mr-3",type:"text",name:"content",placeholder:"Add a Comment"}),a.jsx("button",{type:"submit",onClick:S,disabled:!r,className:"border px-4 py-1 ml-4 font-semibold hover:bg-gray-800",children:"Add"})]})]}),a.jsx("div",{className:" w-[100%]  justify-between ",children:Array.isArray(s)&&(s==null?void 0:s.length)>0&&(s==null?void 0:s.map((e,t)=>{var o,i,b,C,v;return a.jsxs("div",{className:"flex justify-between hover:bg-zinc-900 border border-l-0 border-r-0 border-b-0 py-3 px-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("img",{className:"w-9 h-9 rounded-full",src:`${(o=e==null?void 0:e.owner)==null?void 0:o.avatar}`,alt:""}),a.jsxs("div",{className:"px-3",children:[a.jsxs("div",{className:"flex",children:[a.jsxs("span",{className:"text-gray-300",children:[a.jsx("p",{className:"font-semibold",children:(i=e==null?void 0:e.owner)==null?void 0:i.fullname}),a.jsxs("p",{children:["@",(b=e==null?void 0:e.owner)==null?void 0:b.username]})]}),a.jsxs("p",{className:"ml-3 text-gray-300",children:["Â· ",B(e==null?void 0:e.createdAt)]})]}),a.jsx("div",{className:"mt-2",children:a.jsx("input",{value:u?h:e==null?void 0:e.content,disabled:!u,onChange:M=>x(M.target.value),className:"mt-2 bg-transparent "})})]})]}),a.jsxs("div",{className:"flex",children:[(r==null?void 0:r._id)===((C=e==null?void 0:e.owner)==null?void 0:C._id)&&a.jsx("div",{className:" h-fit w-fit mr-5 flex",children:d&&m===(e==null?void 0:e._id)&&!u&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>y(!0),className:"bg-green-500 px-3",children:"edit"}),a.jsx("button",{className:"bg-red-500 px-3 ml-2",onClick:()=>_(e),children:"delete"})]})}),(r==null?void 0:r._id)===((v=e==null?void 0:e.owner)==null?void 0:v._id)&&a.jsx("div",{className:"cursor-pointer",onClick:()=>k(e==null?void 0:e._id),children:a.jsx(U,{})})]})]},t)}))})]})})},J=E.memo(G);export{J as default};
